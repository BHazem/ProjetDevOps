pipeline {

    agent any
     tools {
        nodejs 'node'
    }


    stages {
        stage("Chekout Git"){
            steps {
                echo "Pulling"
            }
        }





     stage('Build') {
    steps {
        dir('DevOps_Project_Front') {
                        // Build the Angular frontend
                        sh 'npm install'
                        sh 'npm run build'
                    }
    }
}

  stage('SonarQube Analysis') {
            steps {
                // Assuming SonarQube environment is set up correctly
                sh 'npm sonar:sonar -Dsonar.login=admin -Dsonar.password=sonar'
            }
        }
        stage('Deploy to Nexus') {
            steps {
                // Deploy to Nexus repository, ensure Maven is set up with correct settings.xml
                sh 'npm deploy -DskipTests -DaltDeploymentRepository=deploymentRepo::default::http://localhost:8081/repository/Angular-project/'
            }
        }
 stage('Docker Image Build - Frontend') {
            steps {
                script {
                     dir('DevOps_Project_Front') {
                    sh "docker build -t maleksoufi/devops_project:frontApp ."
                }

                }
            }
        }
         stage('Push Docker Image') {
        steps {
            script {
                def dockerUsername = 'maleksoufi'
                def dockerPassword = 'docker123'
                sh "docker login -u $dockerUsername -p $dockerPassword"
                dir('DevOps_Project_Front') {
                    sh 'docker push maleksoufi/devops_project:frontApp'
                }
            }
        }
         }
    }
}

